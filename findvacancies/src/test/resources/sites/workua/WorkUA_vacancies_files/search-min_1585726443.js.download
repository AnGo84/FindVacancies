if(void 0===dataLayer)var dataLayer=[];!function(e){new Class({Extends:ModalWnd,jQuery:"filterWindow",content:null,active:!1,adsLoaded:!1,currentWidth:null,options:{width:992,pressEsc:1,submitform:""},_build:function(){var t=this.options,i=e("body"),n=this;this.wnd=e("<div />",{id:"filter-window",css:{position:"fixed",left:0,top:5e3,zIndex:999,height:"100%",display:"none"},class:"container-absolute"}).appendTo(i),this.isMobile()?this.active=!1:(this.active=document.location.search.search("advs=1")>0,this.adsLoaded=!this.active,this.adsLoaded&&winOnloadBanner()),i.keydown(this.proxied.checkEsc),e(window).on("resize",function(){e("#dropdownMenu1").parent().removeClass("open"),!n.isMobile()&&n.currentWidth<t.width?(n.close(),n.update()):n.isMobile()&&n.currentWidth>=t.width&&(n.close(),n.update()),n.currentWidth=e(document).outerWidth()})},updateCloseEvent:function(){var t=this;this.isMobile()&&e("a.link-close",this.wnd).off("click").on("click",function(){t.close(!1)})},update:function(){var t=this.options;this.isMobile()?(e(t.contentblock).length&&(this.wnd.empty().append(e(t.contentblock)),this.content=!0),this.updateCloseEvent()):(e(t.contentback).append(e(t.contentblock)),this.content=null,e(t.contentback).is(":visible")&&(this.active=!0)),!this.active||this.wnd.find("div").length||e(t.contentback).is(":visible")||this.close(!1),this.$el.trigger("window.update")},open:function(){var t=this,i=this.options;return this.isMobile()?(this.active=!0,e(".card.card-bottom").css({bottom:"-1000px"}).animate({bottom:0},{duration:400}),t.options.pressEsc=0,this.wnd.css({display:"block"}).animate({top:0},{duration:400,complete:function(){e(["header","nav","#center","footer",".shut-off-mess",".holiday-banner-bl"].join(",")).hide(),e(window).scrollTop(0),t.options.pressEsc=1}}),this.$el.trigger("window.open"),this.$el.scrollingFilterOnIOS(),!1):(this.active?(e(".filter-switch-visibility").show(),e(".similar-jobs").length>0&&(e(".similar-jobs").slideToggle(),e("#sim-pad").hide({duration:400})),e(i.contentback).hide(),this.active=!1,e("#advs").val(0),this.adsLoaded||(winOnloadBanner(),this.adsLoaded=!0)):(e(".filter-switch-visibility").hide(),e(".similar-jobs").length>0&&(e(".similar-jobs").slideToggle(),e("#sim-pad").show({duration:400})),e(i.contentback).show(),this.active=!0,e("#advs").val(1)),this.updateAdvsGetParam(this.active),!0)},isMobile:function(){return e(document).outerWidth()<this.options.width},close:function(t){if(!1===this.active)return!1;if(!1===t&&!this.isMobile())return!1;var i=this,n=e.Deferred();return this.$el.trigger("window.close",[void 0===t||t,n]),n.promise().always(function(){e(["header","nav","#center","footer",".holiday-banner-bl"].join(",")).show(),i.wnd.css({display:"none",top:"1000px",position:"fixed"}),i.active=!1}),!1},checkEsc:function(e){this.active&&this.options.pressEsc&&27==e.keyCode&&this.close()},updateAdvsGetParam:function(e){var t=[location.protocol,"//",location.host,location.pathname].join(""),i=document.location.search,n="";e?n=i?i+"&advs=1":"?advs=1":i&&(n=i.replace("advs=1",""),n=n.replace(/([\?&])&/,"$1").replace(/&+$/,"")),n="?"==n?"":n;var o=history.state?history.state:{};o.url=t+n,history.replaceState(o,"",t+n+location.hash),Work.widgets.languageSwitcher.prepareUrls(function(t){var i=t.find("a").attr("href");return e?i+"&advs=1":i.replace("&advs=1","")})}}),new Class({Implements:Options,jQuery:"jobSearch",$el:null,_timer:null,updatePage:!0,updateFilter:!1,paginationReload:!1,stateUrl:null,checkboxes:["category","employment","nosalary","experience","student","noresume","disability","notitle","nosynonym","anyword"],dropdowns:["salaryfrom","salaryto","education"],options:{justForm:!0,searchForm:"#searchform",searchInput:"#search",searchHint:".setsearch",formtype:"shortForm",selector:null,container:null,jobListContainer:null,setFocus:!0,filterWindow:{contentblock:"div.filters-block",contentback:"#filters-block",searchForm:"#searchform"}},topPosition:0,topPositionElement:[],initialize:function(t,i){this.setOptions(i);var n=this.options;return e(n.searchForm).SearchSubmit({formtype:n.formtype}),e(n.searchInput).SearchComplete(),!n.setFocus||document.location.hash.test(/#.+/)||navigator.userAgent.match(/iPhone|iPad|iPod|Android/i)||e(n.searchInput).focus(),e(n.searchHint).setSearch(),n.justForm?(this.viplogos(),this):(e.pjax.defaults.timeout=0,this._build(),this._refreshEvents(),this)},_formSubmitEvent:function(){var t=this.options,i=this;e(t.searchForm).off("submit").on("submit",function(){var n=e(t.searchInput).data("SearchComplete");return n&&n.saveLocalQueries(),i._submit(),!1})},_build:function(){var t=this.options,i=e("body"),n=this;i.filterWindow(t.filterWindow),e("#adv-search").on("click",function(){return i.filterWindow("open")}),i.on("window.open",function(){n.updatePage=!1,n.updateFilter=!0,n.stateUrl=location.href,n._preventMobileNavigationJumping(),n._loadFilters()}).on("window.close",function(i,o,r){n.updatePage=!0,n.updateFilter=!1,o&&n.stateUrl?n._reconnect(function(){return e.pjax.reload(t.container,{url:n.stateUrl})}).done(function(){n._loadFilters(!1),n.stateUrl=null}).done(r.resolve).fail(r.reject):(n.stateUrl=null,r.resolve()),r.resolve()}),this._formSubmitEvent(),e("#adv-search").on("click",function(){e("#adv-bl").slideToggle(200)}),e(document).on("pjax:popstate",function(n){"back"===n.direction&&i.filterWindow("close",!1),e.pjax.reload(t.container,{url:n.url})}),e(document).on("pjax:error",function(){return!1}).on("pjax:success",function(t,i,o,r,s){if(s.push||s.replace){var a=r.getResponseHeader("url"),l=decodeURIComponent(r.getResponseHeader("title")).replace(/\+/g," "),c=history.state;c.url=a,c.title=l,history.replaceState(c,l,a),e("title").html(l),dataLayer.push({event:"VirtualPageview",virtualPageURL:decodeURIComponent(a),virtualPageTitle:l})}n._refreshEvents(),["city","city-id"].forEach(function(t){var i="#"+t+"-helper";e("#"+t).val(e(i).val())}),e("#okMess0:visible").length>0&&e("#okMess0:visible").parent("div.card").remove()})},_getNumberWord:function(e,t){var i=e%10,n=e%100;return i>1&&i<5&&(n>19||n<10)?t[1]:1===i&&11!==n?t[0]:t[2]},_preventMobileNavigationJumping:function(){var t=this,i=function(){e("#filter-window .filters-controls").length>0&&(t.topPosition=e(this)[0].getBoundingClientRect().top+pageYOffset,t.topPositionElement=["#"+e(this).parents(".checkbox").attr("id")],"#undefined"===t.topPositionElement[0]&&(t.topPositionElement=["#"+e(this).parents(".checkbox").parent().attr("id"),e(this).val()]),"#undefined"===t.topPositionElement[0]&&(t.topPositionElement=["#"+e(this).attr("id")]),"#undefined"===t.topPositionElement[0]&&(t.topPositionElement=["#"+e(this).parents(".dropdown").parent().attr("id")],t.topPosition=e(this).parents(".dropdown").parent()[0].getBoundingClientRect().top+pageYOffset))},n=e("#filter-window");n.find("select, input[type=checkbox]").off("change",i).on("change",i),n.find(".period, .sort").off("click",i).on("click",i)},_loadFilters:function(t){function i(){var t=n._filtersCount(),i=n._getNumberWord(t,lang.resumes.condition_plural);return 0!==t?e("#filters-count-row").show():e("#filters-count-row").hide(),lang.resumes.selected_filters.replace(/{count}/g,t).replace(/{plural}/g,i)}var n=this,o=e.Deferred();return t?n._reconnect(function(){return n._disableFilter(),e.ajax({url:t,cache:!1}).success(function(t,o,r){e(".filters-block").html(t);var s=e("#filter-window .filters-controls");if(-1!==["#student_selection","#experience_selection","#disability_selection","#nosalary_selection"].indexOf(n.topPositionElement[0]))a=s.find(n.topPositionElement[0]),s.length>0&&a.length>0&&a.is(":visible")&&s.scrollTop(s.scrollTop()+a.offset().top-n.topPosition+4);else{var a=s.find(n.topPositionElement[0]+(n.topPositionElement[1]?" [value="+n.topPositionElement[1]+"]":""));s.length>0&&a.length>0&&a.is(":visible")?s.scrollTop(s.scrollTop()+a.offset().top-n.topPosition):(a=s.find(n.topPositionElement[0]),s.length>0&&a.length>0&&a.is(":visible")&&s.scrollTop(a.offset().top-45))}n._preventMobileNavigationJumping(),e("#filters-count").html(i()),e("body").filterWindow("updateCloseEvent"),n._refreshFilters().always(function(){n._loadFilters(),n._enableFilter(),n._refreshPeriods()})})}).done(o.resolve).fail(o.reject):(e("#filters-count").html(i()),o.resolve()),o.promise()},_submit:function(t){var i=this.options,n=this,o=e.Deferred();return e(i.searchForm).off("submit").on("submit",function(e){return e.preventDefault(),!1}),t=t||e(this.options.searchForm).SearchSubmit("formAction"),this.updatePage&&(this._disableFilter(),n._reconnect(function(){return e.pjax({url:t,container:n.options.container,scrollTo:!1})}).done(function(){n._enableFilter(),e("body").filterWindow("close",!1)}).done(function(){n._formSubmitEvent()}).done(o.resolve).fail(o.reject)),this.updateFilter&&e.when(this._loadFilters(t)).done(function(){n._formSubmitEvent()}).done(o.resolve).fail(o.reject).always(function(){e(document).trigger("pjax:end")}),o.promise()},_updateDropdowns:function(e){function t(e){var t=i.getFilterListEl(e);i.getTargetEl(e).val(t.val())}var i=this,n=this.dropdowns;void 0!==e&&n.indexOf(e)>-1?t(e):n.forEach(t)},_updateCheckboxes:function(t){function i(t){var i=n.getFilterName(t),o=i!==t?e(document):n.getFilterListEl(t),r=n.getTargetEl(t),s=e("input[type=checkbox]:checked",o),a=e.map(s,function(e){return e.value}).join(" ");r.val(a)}var n=this,o=this.checkboxes;void 0!==t&&-1!==o.indexOf(t)?i(t):o.forEach(i)},_doOrNotRefresh:function(t,i,n){var o=this,r=this.updatePage,s=this.updateFilter;this.updatePage=i,this.updateFilter=n,e.when(t()).done(function(){o.updatePage=r,o.updateFilter=s})},_doNotRefreshThePage:function(e){this._doOrNotRefresh(e,!1,!1)},_doRefreshThePage:function(e){this._doOrNotRefresh(e,!0,!1)},_doRefreshFilters:function(e){this._doOrNotRefresh(e,!1,!0)},_disableFilter:function(){if(!e(".event-prevent").length){e(".filters-block").addClass("loading").find(".loading-block").removeClass("hidden"),e([this.options.container,"#filter-window"].join(",")).find("select, input[type=checkbox]").off("change");var t=e("<div />",{css:{position:"absolute",left:0,right:0,height:"100%",width:"100%",zIndex:999}}).addClass("event-prevent");[this.options.container,".header-info","#filter-window"].each(function(i){e(i).css("pointer-events","none").prepend(t).find("select, input[type=checkbox], a").keydown(function(e){9===e.keyCode&&e.preventDefault()})})}},_enableFilter:function(){e(".filters-block").removeClass("loading").find(".loading-block").addClass("hidden"),[this.options.container,".header-info","#filter-window"].each(function(t){e(t).css("pointer-events","auto").find("select, input[type=checkbox], a").unbind("keydown")}),e(".event-prevent").remove()},_reconnect:function(t){var i=this;i._timer&&clearTimeout(i._timer);var n=e.Deferred(),o=function(){var r=t(),s=function(){e("body").addClass("disconnect"),e(".filters-block").css("opacity",1),i._timer=setTimeout(o,1e3)};r?("function"==typeof r.success?r.success(n.resolve):"function"==typeof r.done&&r.done(n.resolve),"function"==typeof r.fail?r.fail(s):"function"==typeof r.error&&r.error(s)):n.resolve()};return i._timer=o(),n.promise().done(function(){e("body").removeClass("disconnect"),e(".filters-block").attr("style",null)})},_filtersUpdate:function(){e(".add-top").html()&&(this._updateDropdowns(),this._updateCheckboxes())},_filtersReset:function(){var t=this,i=e("#city-id").val(),n=e("#search").val(),o=e("#sort").val(),r=e("#days").val(),s=e.Deferred(),a="/jobs/?region="+i+"&search="+n+"&sort="+o+"&days="+r;return this._doRefreshFilters(function(){t._reconnect(function(){return t._loadFilters(a)}).done(function(){t._filtersUpdate()}).done(s.resolve).fail(s.reject)}),s.promise()},_filtersApply:function(){var t=this,i=e.Deferred();return this._doRefreshThePage(function(){t._submit().done(function(){i.resolve()})}),e(document).scrollTop(0),i.promise()},_filtersCount:function(){var t=e(".filters-block");return parseInt(t.find("input:checkbox:checked").length+t.find("select").filter(function(t,i){return"0"!==e(i).val()}).length,10)},_refreshPeriods:function(t){function i(t,i){var n=e(t).data(i);e("#"+i).val(n),s._submit().done(function(){s._loadFilters()})}function n(e){e.preventDefault(),i(this,"days")}function o(e){e.preventDefault(),i(this,"sort")}function r(t){t.preventDefault();var i=e(this).data("desc"),n=void 0!==window.location.search?window.location.search.match(/page=(\d{1,})/i):0;0===e("#desc").length&&(e("<input type='hidden' value='"+i+"'/>").attr("id","desc").attr("name","desc").appendTo(s.options.searchForm),n&&void 0!==n[1]&&n[1]>0&&e("<input type='hidden' value='"+n[1]+"'/>").attr("id","page_val").attr("name","page").appendTo(s.options.searchForm)),s._submit().done(function(){e("#desc").remove(),e("#page_val").remove()})}var s=this;if(t){var a=e("#dropdownMenu1"),l=e("#dropdownMenu2");a.next().find("a.days").on("click",n),l.next().find("a.sort").on("click",o),l.next().find("a.desc").on("click",r)}var c=e(".additional-filter");c.find("a.period").on("click",n),c.find("a.sort").on("click",o)},getFilterListId:function(e){return e+"_selection"},getFilterListEl:function(t){return e("#"+this.getFilterListId(t))},getFilterName:function(e){var t=this.getFilterListEl(e);return t.data("target")?t.data("target"):e},getTargetId:function(e){var t=this.getFilterListEl(e);return t.data("target")?t.data("target"):e},getTargetEl:function(t){return e("#"+this.getTargetId(t))},_refreshFilters:function(){var t=this,i=[],n=e.Deferred();return this.dropdowns.each(function(n){var o=t.getFilterListEl(n),r="#"+n;o.on("change",function(s,a){s.stopPropagation(),"#salaryfrom"===r&&0===o.val().toString()&&e("#salaryto").val(o.val()),"#salaryto"===r&&0===o.val().toString()&&e("#salaryfrom").val(o.val()),t._updateDropdowns(n);var l=t._submit();l.done(function(){"function"==typeof a&&a()}),i.push(l),e(this).blur()})}),this.checkboxes.each(function(n){var o=t.getFilterListEl(n);e("input[type=checkbox]",o).on("change",function(e,o){t._updateCheckboxes(n);var r=t._submit();r.done(function(){"function"==typeof o&&o()}),i.push(r)})}),e("#city-header").empty().append(e("#city-header-helper").html()),e("#cat_more").off("click").on("click",function(){return e("div.checkbox",e("#category_selection")).removeClass("hide"),e(this).remove(),!1}),e("a.catlink").off("click").on("click",function(){return e(this).siblings("input[type='checkbox']").prop("checked",function(e,t){return!t}).trigger("change"),!1}),e("#filters-apply").off("click").on("click",function(e){i.push(t._filtersApply())}),e("#filters-reset").off("click").on("click",function(e){t.topPosition=0,t.topPositionElement=[],i.push(t._filtersReset())}),e.when.apply(this,i).done(n.resolve).fail(n.reject),n.promise()},_refreshEvents:function(){var t=this.options,i=e("body"),n=this;if(this.viplogos(),e(".job-link").setClickBlock(),e(document).popoverInit(),e(".col-md-4 .no-style a").off("click").on("click",function(){e(this).parents("ul").children(".hide").removeClass("hide"),e(this).parent().hide()}),Work.widgets.languageSwitcher.prepareUrls(function(t){var i=e("#locales-active-path");if(i.size()&&!t.hasClass("active")){var n=i.val();return n=n+(-1===n.indexOf("?")?"?":"&")+"setlp="+t.data("locale"),Work.localeService.getURLPrefix(t.data("locale"))+n}}),n.paginationReload)return n.addPaginationEvents(t.selector,t.jobListContainer),void n._refreshFilters();this._doNotRefreshThePage(function(){n._filtersUpdate()}),i.filterWindow("update"),e(t.searchForm).length>0&&(this._refreshFilters(),this._refreshPeriods(!0),e("span.removefilter").on("click",function(){var t=e(this),i=e("#"+t.data("check"));return i.length>0&&(e("input[value="+t.data("id")+"]",i).length>0?e("input[value="+t.data("id")+"]",i).prop("checked",!1).trigger("change",function(){t.parent().remove()}):i.val(0).trigger("change",function(){t.parent().remove()})),!1}),n.addPaginationEvents(t.selector,t.jobListContainer),e(".filter-reset").on("click",function(t){t.preventDefault(),n._doNotRefreshThePage(function(){e("span.removefilter").click()}),n._submit()}),n.saSignEvent())},addPaginationEvents:function(t,i){var n=this;n.paginationReload=!1,e(t).on("click",function(t){t.preventDefault();var o=e(this).attr("href"),r=!0;n.paginationReload=!0,n._disableFilter(),n._reconnect(function(){return e.pjax.reload(i,{url:o,scrollTo:0,push:!0,replace:!1,fragment:i}).fail(function(){r&&(e("#searchform")[0].scrollIntoView(),r=!1)})}).done(function(){n._enableFilter(),e("body").filterWindow("isMobile")||e(n.options.filterWindow.contentback).is(":visible")||!e("#bannerSticky").length||(e(".job-link").length<4||e("#bannerSticky").offset().top-225>e(".pagination").offset().top?e("#bannerSticky").hide():e("#bannerSticky").show())})})},saSignEvent:function(){function t(t,i,n){e.ajax({type:"POST",dataType:"json",url:"/_data/_ajax/jsa_sign_fromSearch.php",cache:!1,data:{jsaSign:1,email:t,jsaArr:i,jsaParam:n},success:function(t){void 0!=t.err?(e("#sa_sign").parent().addClass("has-danger"),e("#sign_err").html(t.err),e("#signJsa").prop("disabled",!1)):(e("#sa_sign").parent().removeClass("has-danger"),e("#jsaCreatedName").html(t.jsa_name),e("#sign_err").html(""),e("#jsaF0").css("display","none"),2==t.create&&e("#okMess0").html(t.warn),e("#okMess0").show()),"undefined"!=typeof telegramSubscribeBtn&&telegramSubscribeBtn.hideErrorAlert()}})}e("#signJsa").length&&e("#signJsa").click(function(){e(this).prop("disabled",!0),t(e("#sa_sign").val(),{search:e("#search").val(),region:e(".js-rvalue").val(),category:e("#category").val()},"search")})},viplogos:function(){if(0!=e("#vip_logos").length){var t="";for(var i in vpl){var n=i.replace("_","");t+='<a href="/jobs/by-company/'+n+'/" title="'+lang.jobs.jbin.replace("{0}",vpl[i])+'" class="item-logo">\t\t\t\t<div class="item-logo-img e'+n+'"></div>\t\t\t\t</a>'}e("#vip_logos").append(t),e("#vip_logos .item-logo").length>3&&e("#vip_logos").DrumSlider({elsSelector:"#vip_logos .item-logo",arrows:"#vip_logos .slide-left, #vip_logos .slide-right",duration:500,needClone:!0,lg:{picWidth:142,step:568,picPerFrame:4},md:{picWidth:135,step:540,picPerFrame:4},sm:{picWidth:132,step:660,picPerFrame:5},xs:{picWidth:130,step:"auto",picPerFrame:"auto"}})}}})}(jQuery);